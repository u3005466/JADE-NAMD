In the case of "No map to state **, you need to resolve more vectors" messages, this is usually an indication that one did not include enough excited states in the TD or CIS calculation. The "States=N" option to the "TD" or "CIS" keywords tells how many excited states to include in an excited state energy calculation. If this is not specified, the default value will be "States=3". The recommended value is to include a minimum of 2 or 3 more states than the state of interest. Thus, if you want to perform a geometry optimization for excited state 5, for example, I would recommend at least using "States=7" or "States=8". The geometry optimization will be done for one excited state M, selected with "Root=M", and one has to make sure that enough states are included in the CIS or TD expansion by having "States=N" where N is larger than M.
It is possible that, at some point during an optimization of an excited state, the order of the excited states changes and the CIS or TD expansion might need to include more states in order to be able to follow correctly the state of interest. This is essentially what that message about including more vectors mean, that is that at that point, the number of states that you originally specified with "States=N" was not enough in order to solve for the state of interest, so a larger number "N" will need to be used for "States=N".
Other times, the problem is that the ground state wavefunction becomes unstable, that is one of the states that was an excited at the initial geometry now becomes lower in energy than the state that was the ground state at the initial geometry. This kind of situation, unfortunately, cannot be modeled properly with single determinant expansions such as CIS or TD, and one would need to use CAS in order to be able to deal with the conical intersection or avoided crossing of states.
Another thing to note is that one should be much more careful with geometry optimizations on excited states than for the ground state. Typically the energy differences among excited states are smaller than between the ground state and the first excited state. Thus, one can afford to perform larger geometry optimization steps when optimizing the ground state than in the case of optimizing an excited state. 
A "bad" geometry optimization step in the optimization of the ground state, may take you a bit off track but in following steps the optimization might find the way back and approach the converged structure. In the case of an optimization of an excited state, a "bad" geometry optimization step will also take you off track but, since other electronic states are close in energy, it is possible that at the new geometry the order of the excited states change and now the geometry optimization follows a different electronic state. 
This is not only a problem because the optimization could be pursuing a different state than the one you were interested in, but also because, if several of these changes occur during a geometry optimization, it may even be hopeless to continue with the optimization because the gradient information and the estimated hessian could be useless (since not all the previous points in the geometry optimization where points from the same potential energy surface).
As a first measure to increase the reliability of the geometry optimization of excited states, I recommend to reduce the maximum allowed step size during geometry optimizations. Try "Opt=(MaxStep=10)" to set this value to 0.10 Bohr, or a smaller value if you still have problems. The default value is typically 0.30 Bohr. Reducing the maximum allowed step size will result in the geometry optimization taking more steps to reach convergence than with the default value. This will be true obviously for well-behaved geometry optimizations, but for problematic cases it will be the other way around, i.e. it will take fewer steps (and may even be impossible with the default step size) because it will be easier for the optimizer to follow a particular electronic state if the changes from step to step are not very drastic.
